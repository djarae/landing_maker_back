@page "{id:int}"
@model LandingMakerBack.Pages.Landings.EditModel
@{
    ViewData["Title"] = $"Editar: {Model.Landing?.Name}";
}

<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - Landing Maker</title>
    <link rel="stylesheet" href="~/css/site.css" />
    <link rel="stylesheet" href="~/css/edit.css" />
</head>
<body>
    <div class="container edit-container">
        <header class="edit-header">
            <div class="header-left">
                <a href="/Landings" class="back-link">‚Üê Volver</a>
                <h1>‚úèÔ∏è @Model.Landing?.Name</h1>
            </div>
            <div class="header-right">
                <span class="preset-badge @Model.Landing?.PresetType.ToString().ToLower()">
                    @(Model.Landing?.PresetType.ToString() == "MobileApp" ? "üì± Mobile App" : "üè™ Pyme")
                </span>
                <span class="style-badge">@Model.Landing?.StyleType</span>
            </div>
        </header>
        
        <main class="edit-main">
            @if (!string.IsNullOrEmpty(Model.SuccessMessage))
            {
                <div class="alert alert-success">
                    ‚úÖ @Model.SuccessMessage
                </div>
            }
            
            <form method="post" class="edit-form">
                <input type="hidden" asp-for="Landing.Id" />
                
                <!-- Informaci√≥n General -->
                <div class="edit-section">
                    <h2>üìù Informaci√≥n General</h2>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="Name">Nombre de la landing</label>
                            <input type="text" id="Name" asp-for="Landing.Name" class="form-control" />
                        </div>
                        <div class="form-group">
                            <label for="ThemeMode">Modo de tema</label>
                            <select asp-for="Landing.ThemeMode" class="form-control">
                                <option value="Toggle">Toggle (usuario puede cambiar)</option>
                                <option value="DayOnly">Solo modo d√≠a</option>
                                <option value="NightOnly">Solo modo noche</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <!-- Secciones -->
                <div class="edit-section">
                    <h2>üìë Contenido de las Secciones</h2>
                    <p class="section-description">Edita el contenido JSON de cada secci√≥n</p>
                    
                    @if (Model.Sections != null)
                    {
                        @for (int i = 0; i < Model.Sections.Count; i++)
                        {
                            <div class="section-editor">
                                <div class="section-header">
                                    <span class="section-type">@Model.Sections[i].SectionType.ToUpper()</span>
                                    <span class="section-order">Orden: @Model.Sections[i].Order</span>
                                </div>
                                <input type="hidden" name="Sections[@i].Id" value="@Model.Sections[i].Id" />
                                <input type="hidden" name="Sections[@i].SectionType" value="@Model.Sections[i].SectionType" />
                                <input type="hidden" name="Sections[@i].Order" value="@Model.Sections[i].Order" />
                                <textarea 
                                    name="Sections[@i].ConfigJson" 
                                    class="form-control config-editor"
                                    rows="8"
                                >@Model.Sections[i].ConfigJson</textarea>
                            </div>
                        }
                    }
                </div>
                
                <!-- Publicaci√≥n -->
                <div class="edit-section publish-section">
                    <h2>üöÄ Publicaci√≥n</h2>
                    <div class="publish-status">
                        <label class="checkbox-label">
                            <input type="checkbox" asp-for="Landing.IsPublished" />
                            <span>Landing publicada</span>
                        </label>
                        <p class="publish-hint">
                            @if (Model.Landing?.IsPublished == true)
                            {
                                <span class="status published">‚úÖ Visible en: <a href="http://localhost:5173/?id=@Model.Landing.Id" target="_blank">localhost:5173/?id=@Model.Landing.Id</a></span>
                            }
                            else
                            {
                                <span class="status draft">‚ö†Ô∏è Esta landing no es visible p√∫blicamente</span>
                            }
                        </p>
                    </div>
                </div>
                
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary btn-lg">üíæ Guardar Cambios</button>
                    <a href="http://localhost:5173/?id=@Model.Landing?.Id" target="_blank" class="btn btn-secondary">üëÅÔ∏è Vista Previa</a>
                </div>
            </form>
        </main>
    </div>
</body>
</html>
